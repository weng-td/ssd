import{g as we}from"./_commonjsHelpers.725317a4.js";function be(re,ve){for(var te=0;te<ve.length;te++){const Q=ve[te];if(typeof Q!="string"&&!Array.isArray(Q)){for(const Y in Q)if(Y!=="default"&&!(Y in re)){const ie=Object.getOwnPropertyDescriptor(Q,Y);ie&&Object.defineProperty(re,Y,ie.get?ie:{enumerable:!0,get:()=>Q[Y]})}}}return Object.freeze(Object.defineProperty(re,Symbol.toStringTag,{value:"Module"}))}var Le={exports:{}};(function(re,ve){(function(te,Q){re.exports=Q()})(self,()=>(()=>{var te={965:function(F,e,d){var l=this&&this.__decorate||function(E,r,u,C){var s,n=arguments.length,m=n<3?r:C===null?C=Object.getOwnPropertyDescriptor(r,u):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(E,r,u,C);else for(var h=E.length-1;h>=0;h--)(s=E[h])&&(m=(n<3?s(m):n>3?s(r,u,m):s(r,u))||m);return n>3&&m&&Object.defineProperty(r,u,m),m};Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRenderer=void 0;const a=d(374),o=d(509),_=d(855),p=d(859),c=d(776),i=d(381),t=11,g=t*Float32Array.BYTES_PER_ELEMENT;let L,x=0,S=0,R=0;class A extends p.Disposable{constructor(r,u,C){super(),this._terminal=r,this._gl=u,this._dimensions=C,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};const s=this._gl;o.TextureAtlas.maxAtlasPages===void 0&&(o.TextureAtlas.maxAtlasPages=Math.min(32,(0,a.throwIfFalsy)(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS))),o.TextureAtlas.maxTextureSize=(0,a.throwIfFalsy)(s.getParameter(s.MAX_TEXTURE_SIZE))),this._program=(0,a.throwIfFalsy)((0,i.createProgram)(s,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(b){let y="";for(let w=1;w<b;w++)y+=` else if (v_texpage == ${w}) { outColor = texture(u_texture[${w}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${b}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${y}
}`}(o.TextureAtlas.maxAtlasPages))),this.register((0,p.toDisposable)(()=>s.deleteProgram(this._program))),this._projectionLocation=(0,a.throwIfFalsy)(s.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,a.throwIfFalsy)(s.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,a.throwIfFalsy)(s.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=s.createVertexArray(),s.bindVertexArray(this._vertexArrayObject);const n=new Float32Array([0,0,1,0,0,1,1,1]),m=s.createBuffer();this.register((0,p.toDisposable)(()=>s.deleteBuffer(m))),s.bindBuffer(s.ARRAY_BUFFER,m),s.bufferData(s.ARRAY_BUFFER,n,s.STATIC_DRAW),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);const h=new Uint8Array([0,1,2,3]),v=s.createBuffer();this.register((0,p.toDisposable)(()=>s.deleteBuffer(v))),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,v),s.bufferData(s.ELEMENT_ARRAY_BUFFER,h,s.STATIC_DRAW),this._attributesBuffer=(0,a.throwIfFalsy)(s.createBuffer()),this.register((0,p.toDisposable)(()=>s.deleteBuffer(this._attributesBuffer))),s.bindBuffer(s.ARRAY_BUFFER,this._attributesBuffer),s.enableVertexAttribArray(2),s.vertexAttribPointer(2,2,s.FLOAT,!1,g,0),s.vertexAttribDivisor(2,1),s.enableVertexAttribArray(3),s.vertexAttribPointer(3,2,s.FLOAT,!1,g,2*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(3,1),s.enableVertexAttribArray(4),s.vertexAttribPointer(4,1,s.FLOAT,!1,g,4*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(4,1),s.enableVertexAttribArray(5),s.vertexAttribPointer(5,2,s.FLOAT,!1,g,5*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(5,1),s.enableVertexAttribArray(6),s.vertexAttribPointer(6,2,s.FLOAT,!1,g,7*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(6,1),s.enableVertexAttribArray(1),s.vertexAttribPointer(1,2,s.FLOAT,!1,g,9*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(1,1),s.useProgram(this._program);const f=new Int32Array(o.TextureAtlas.maxAtlasPages);for(let b=0;b<o.TextureAtlas.maxAtlasPages;b++)f[b]=b;s.uniform1iv(this._textureLocation,f),s.uniformMatrix4fv(this._projectionLocation,!1,i.PROJECTION_MATRIX),this._atlasTextures=[];for(let b=0;b<o.TextureAtlas.maxAtlasPages;b++){const y=new i.GLTexture((0,a.throwIfFalsy)(s.createTexture()));this.register((0,p.toDisposable)(()=>s.deleteTexture(y.texture))),s.activeTexture(s.TEXTURE0+b),s.bindTexture(s.TEXTURE_2D,y.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[b]=y}s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(r,u,C,s,n,m,h,v){this._updateCell(this._vertices.attributes,r,u,C,s,n,m,h,v)}_updateCell(r,u,C,s,n,m,h,v,f){x=(C*this._terminal.cols+u)*t,s!==_.NULL_CELL_CODE&&s!==void 0?this._atlas&&(L=v&&v.length>1?this._atlas.getRasterizedGlyphCombinedChar(v,n,m,h,!1):this._atlas.getRasterizedGlyph(s,n,m,h,!1),S=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),n!==f&&L.offset.x>S?(R=L.offset.x-S,r[x]=-(L.offset.x-R)+this._dimensions.device.char.left,r[x+1]=-L.offset.y+this._dimensions.device.char.top,r[x+2]=(L.size.x-R)/this._dimensions.device.canvas.width,r[x+3]=L.size.y/this._dimensions.device.canvas.height,r[x+4]=L.texturePage,r[x+5]=L.texturePositionClipSpace.x+R/this._atlas.pages[L.texturePage].canvas.width,r[x+6]=L.texturePositionClipSpace.y,r[x+7]=L.sizeClipSpace.x-R/this._atlas.pages[L.texturePage].canvas.width,r[x+8]=L.sizeClipSpace.y):(r[x]=-L.offset.x+this._dimensions.device.char.left,r[x+1]=-L.offset.y+this._dimensions.device.char.top,r[x+2]=L.size.x/this._dimensions.device.canvas.width,r[x+3]=L.size.y/this._dimensions.device.canvas.height,r[x+4]=L.texturePage,r[x+5]=L.texturePositionClipSpace.x,r[x+6]=L.texturePositionClipSpace.y,r[x+7]=L.sizeClipSpace.x,r[x+8]=L.sizeClipSpace.y)):r.fill(0,x,x+t-1-2)}clear(){const r=this._terminal,u=r.cols*r.rows*t;this._vertices.count!==u?this._vertices.attributes=new Float32Array(u):this._vertices.attributes.fill(0);let C=0;for(;C<this._vertices.attributesBuffers.length;C++)this._vertices.count!==u?this._vertices.attributesBuffers[C]=new Float32Array(u):this._vertices.attributesBuffers[C].fill(0);this._vertices.count=u,C=0;for(let s=0;s<r.rows;s++)for(let n=0;n<r.cols;n++)this._vertices.attributes[C+9]=n/r.cols,this._vertices.attributes[C+10]=s/r.rows,C+=t}handleResize(){const r=this._gl;r.useProgram(this._program),r.viewport(0,0,r.canvas.width,r.canvas.height),r.uniform2f(this._resolutionLocation,r.canvas.width,r.canvas.height),this.clear()}render(r){if(!this._atlas)return;const u=this._gl;u.useProgram(this._program),u.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;const C=this._vertices.attributesBuffers[this._activeBuffer];let s=0;for(let n=0;n<r.lineLengths.length;n++){const m=n*this._terminal.cols*t,h=this._vertices.attributes.subarray(m,m+r.lineLengths[n]*t);C.set(h,s),s+=h.length}u.bindBuffer(u.ARRAY_BUFFER,this._attributesBuffer),u.bufferData(u.ARRAY_BUFFER,C.subarray(0,s),u.STREAM_DRAW);for(let n=0;n<this._atlas.pages.length;n++)this._atlas.pages[n].version!==this._atlasTextures[n].version&&this._bindAtlasPageTexture(u,this._atlas,n);u.drawElementsInstanced(u.TRIANGLE_STRIP,4,u.UNSIGNED_BYTE,0,s/t)}setAtlas(r){this._atlas=r;for(const u of this._atlasTextures)u.version=-1}_bindAtlasPageTexture(r,u,C){r.activeTexture(r.TEXTURE0+C),r.bindTexture(r.TEXTURE_2D,this._atlasTextures[C].texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,u.pages[C].canvas),r.generateMipmap(r.TEXTURE_2D),this._atlasTextures[C].version=u.pages[C].version}setDimensions(r){this._dimensions=r}}e.GlyphRenderer=A,l([c.traceCall],A.prototype,"updateCell",null)},742:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleRenderer=void 0;const l=d(374),a=d(859),o=d(310),_=d(381),p=8*Float32Array.BYTES_PER_ELEMENT;class c{constructor(){this.attributes=new Float32Array(160),this.count=0}}let i=0,t=0,g=0,L=0,x=0,S=0,R=0;class A extends a.Disposable{constructor(r,u,C,s){super(),this._terminal=r,this._gl=u,this._dimensions=C,this._themeService=s,this._vertices=new c,this._verticesCursor=new c;const n=this._gl;this._program=(0,l.throwIfFalsy)((0,_.createProgram)(n,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,a.toDisposable)(()=>n.deleteProgram(this._program))),this._projectionLocation=(0,l.throwIfFalsy)(n.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=n.createVertexArray(),n.bindVertexArray(this._vertexArrayObject);const m=new Float32Array([0,0,1,0,0,1,1,1]),h=n.createBuffer();this.register((0,a.toDisposable)(()=>n.deleteBuffer(h))),n.bindBuffer(n.ARRAY_BUFFER,h),n.bufferData(n.ARRAY_BUFFER,m,n.STATIC_DRAW),n.enableVertexAttribArray(3),n.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);const v=new Uint8Array([0,1,2,3]),f=n.createBuffer();this.register((0,a.toDisposable)(()=>n.deleteBuffer(f))),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,f),n.bufferData(n.ELEMENT_ARRAY_BUFFER,v,n.STATIC_DRAW),this._attributesBuffer=(0,l.throwIfFalsy)(n.createBuffer()),this.register((0,a.toDisposable)(()=>n.deleteBuffer(this._attributesBuffer))),n.bindBuffer(n.ARRAY_BUFFER,this._attributesBuffer),n.enableVertexAttribArray(0),n.vertexAttribPointer(0,2,n.FLOAT,!1,p,0),n.vertexAttribDivisor(0,1),n.enableVertexAttribArray(1),n.vertexAttribPointer(1,2,n.FLOAT,!1,p,2*Float32Array.BYTES_PER_ELEMENT),n.vertexAttribDivisor(1,1),n.enableVertexAttribArray(2),n.vertexAttribPointer(2,4,n.FLOAT,!1,p,4*Float32Array.BYTES_PER_ELEMENT),n.vertexAttribDivisor(2,1),this._updateCachedColors(s.colors),this.register(this._themeService.onChangeColors(b=>{this._updateCachedColors(b),this._updateViewportRectangle()}))}renderBackgrounds(){this._renderVertices(this._vertices)}renderCursor(){this._renderVertices(this._verticesCursor)}_renderVertices(r){const u=this._gl;u.useProgram(this._program),u.bindVertexArray(this._vertexArrayObject),u.uniformMatrix4fv(this._projectionLocation,!1,_.PROJECTION_MATRIX),u.bindBuffer(u.ARRAY_BUFFER,this._attributesBuffer),u.bufferData(u.ARRAY_BUFFER,r.attributes,u.DYNAMIC_DRAW),u.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,u.UNSIGNED_BYTE,0,r.count)}handleResize(){this._updateViewportRectangle()}setDimensions(r){this._dimensions=r}_updateCachedColors(r){this._bgFloat=this._colorToFloat32Array(r.background),this._cursorFloat=this._colorToFloat32Array(r.cursor)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(r){const u=this._terminal,C=this._vertices;let s,n,m,h,v,f,b,y,w,M,D,T=1;for(s=0;s<u.rows;s++){for(m=-1,h=0,v=0,f=!1,n=0;n<u.cols;n++)b=(s*u.cols+n)*o.RENDER_MODEL_INDICIES_PER_CELL,y=r.cells[b+o.RENDER_MODEL_BG_OFFSET],w=r.cells[b+o.RENDER_MODEL_FG_OFFSET],M=!!(67108864&w),(y!==h||w!==v&&(f||M))&&((h!==0||f&&v!==0)&&(D=8*T++,this._updateRectangle(C,D,v,h,m,n,s)),m=n,h=y,v=w,f=M);(h!==0||f&&v!==0)&&(D=8*T++,this._updateRectangle(C,D,v,h,m,u.cols,s))}C.count=T}updateCursor(r){const u=this._verticesCursor,C=r.cursor;if(!C||C.style==="block")return void(u.count=0);let s,n=0;C.style!=="bar"&&C.style!=="outline"||(s=8*n++,this._addRectangleFloat(u.attributes,s,C.x*this._dimensions.device.cell.width,C.y*this._dimensions.device.cell.height,C.style==="bar"?C.dpr*C.cursorWidth:C.dpr,this._dimensions.device.cell.height,this._cursorFloat)),C.style!=="underline"&&C.style!=="outline"||(s=8*n++,this._addRectangleFloat(u.attributes,s,C.x*this._dimensions.device.cell.width,(C.y+1)*this._dimensions.device.cell.height-C.dpr,C.width*this._dimensions.device.cell.width,C.dpr,this._cursorFloat)),C.style==="outline"&&(s=8*n++,this._addRectangleFloat(u.attributes,s,C.x*this._dimensions.device.cell.width,C.y*this._dimensions.device.cell.height,C.width*this._dimensions.device.cell.width,C.dpr,this._cursorFloat),s=8*n++,this._addRectangleFloat(u.attributes,s,(C.x+C.width)*this._dimensions.device.cell.width-C.dpr,C.y*this._dimensions.device.cell.height,C.dpr,this._dimensions.device.cell.height,this._cursorFloat)),u.count=n}_updateRectangle(r,u,C,s,n,m,h){if(67108864&C)switch(50331648&C){case 16777216:case 33554432:i=this._themeService.colors.ansi[255&C].rgba;break;case 50331648:i=(16777215&C)<<8;break;default:i=this._themeService.colors.foreground.rgba}else switch(50331648&s){case 16777216:case 33554432:i=this._themeService.colors.ansi[255&s].rgba;break;case 50331648:i=(16777215&s)<<8;break;default:i=this._themeService.colors.background.rgba}r.attributes.length<u+4&&(r.attributes=(0,_.expandFloat32Array)(r.attributes,this._terminal.rows*this._terminal.cols*8)),t=n*this._dimensions.device.cell.width,g=h*this._dimensions.device.cell.height,L=(i>>24&255)/255,x=(i>>16&255)/255,S=(i>>8&255)/255,R=1,this._addRectangle(r.attributes,u,t,g,(m-n)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,L,x,S,R)}_addRectangle(r,u,C,s,n,m,h,v,f,b){r[u]=C/this._dimensions.device.canvas.width,r[u+1]=s/this._dimensions.device.canvas.height,r[u+2]=n/this._dimensions.device.canvas.width,r[u+3]=m/this._dimensions.device.canvas.height,r[u+4]=h,r[u+5]=v,r[u+6]=f,r[u+7]=b}_addRectangleFloat(r,u,C,s,n,m,h){r[u]=C/this._dimensions.device.canvas.width,r[u+1]=s/this._dimensions.device.canvas.height,r[u+2]=n/this._dimensions.device.canvas.width,r[u+3]=m/this._dimensions.device.canvas.height,r[u+4]=h[0],r[u+5]=h[1],r[u+6]=h[2],r[u+7]=h[3]}_colorToFloat32Array(r){return new Float32Array([(r.rgba>>24&255)/255,(r.rgba>>16&255)/255,(r.rgba>>8&255)/255,(255&r.rgba)/255])}}e.RectangleRenderer=A},310:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderModel=e.COMBINED_CHAR_BIT_MASK=e.RENDER_MODEL_EXT_OFFSET=e.RENDER_MODEL_FG_OFFSET=e.RENDER_MODEL_BG_OFFSET=e.RENDER_MODEL_INDICIES_PER_CELL=void 0;const l=d(296);e.RENDER_MODEL_INDICIES_PER_CELL=4,e.RENDER_MODEL_BG_OFFSET=1,e.RENDER_MODEL_FG_OFFSET=2,e.RENDER_MODEL_EXT_OFFSET=3,e.COMBINED_CHAR_BIT_MASK=2147483648,e.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,l.createSelectionRenderModel)()}resize(a,o){const _=a*o*e.RENDER_MODEL_INDICIES_PER_CELL;_!==this.cells.length&&(this.cells=new Uint32Array(_),this.lineLengths=new Uint32Array(o))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:function(F,e,d){var l=this&&this.__decorate||function(m,h,v,f){var b,y=arguments.length,w=y<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,v):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(m,h,v,f);else for(var M=m.length-1;M>=0;M--)(b=m[M])&&(w=(y<3?b(w):y>3?b(h,v,w):b(h,v))||w);return y>3&&w&&Object.defineProperty(h,v,w),w};Object.defineProperty(e,"__esModule",{value:!0}),e.JoinedCellData=e.WebglRenderer=void 0;const a=d(820),o=d(274),_=d(627),p=d(457),c=d(56),i=d(374),t=d(345),g=d(859),L=d(147),x=d(782),S=d(855),R=d(776),A=d(965),E=d(742),r=d(310),u=d(733);class C extends g.Disposable{constructor(h,v,f,b,y,w,M,D,T){super(),this._terminal=h,this._characterJoinerService=v,this._charSizeService=f,this._coreBrowserService=b,this._coreService=y,this._decorationService=w,this._optionsService=M,this._themeService=D,this._cursorBlinkStateManager=new g.MutableDisposable,this._charAtlasDisposable=this.register(new g.MutableDisposable),this._model=new r.RenderModel,this._workCell=new x.CellData,this._rectangleRenderer=this.register(new g.MutableDisposable),this._glyphRenderer=this.register(new g.MutableDisposable),this._onChangeTextureAtlas=this.register(new t.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new t.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new t.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new t.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new t.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new o.CellColorResolver(this._terminal,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new u.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier2,this._coreBrowserService,M,this._themeService)],this.dimensions=(0,i.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this._updateCursorBlink(),this.register(M.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=document.createElement("canvas");const z={antialias:!1,depth:!1,preserveDrawingBuffer:T};if(this._gl=this._canvas.getContext("webgl2",z),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,a.addDisposableDomListener)(this._canvas,"webglcontextlost",B=>{console.log("webglcontextlost event received"),B.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(B)},3e3)})),this.register((0,a.addDisposableDomListener)(this._canvas,"webglcontextrestored",B=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,_.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this.register((0,c.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(B,H)=>this._setCanvasDevicePixelDimensions(B,H))),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer.value,this._glyphRenderer.value]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,g.toDisposable)(()=>{var B;for(const H of this._renderLayers)H.dispose();(B=this._canvas.parentElement)===null||B===void 0||B.removeChild(this._canvas),(0,_.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var h;return(h=this._charAtlas)===null||h===void 0?void 0:h.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(h,v){var f,b,y,w;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(const M of this._renderLayers)M.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,(f=this._rectangleRenderer.value)===null||f===void 0||f.setDimensions(this.dimensions),(b=this._rectangleRenderer.value)===null||b===void 0||b.handleResize(),(y=this._glyphRenderer.value)===null||y===void 0||y.setDimensions(this.dimensions),(w=this._glyphRenderer.value)===null||w===void 0||w.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){var h;for(const v of this._renderLayers)v.handleBlur(this._terminal);(h=this._cursorBlinkStateManager.value)===null||h===void 0||h.pause(),this._requestRedrawViewport()}handleFocus(){var h;for(const v of this._renderLayers)v.handleFocus(this._terminal);(h=this._cursorBlinkStateManager.value)===null||h===void 0||h.resume(),this._requestRedrawViewport()}handleSelectionChanged(h,v,f){for(const b of this._renderLayers)b.handleSelectionChanged(this._terminal,h,v,f);this._model.selection.update(this._terminal,h,v,f),this._requestRedrawViewport()}handleCursorMove(){var h;for(const v of this._renderLayers)v.handleCursorMove(this._terminal);(h=this._cursorBlinkStateManager.value)===null||h===void 0||h.restartBlinkAnimation()}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}_initializeWebGLState(){return this._rectangleRenderer.value=new E.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new A.GlyphRenderer(this._terminal,this._gl,this.dimensions),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}_refreshCharAtlas(){var h;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);const v=(0,_.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==v&&(this._onChangeTextureAtlas.fire(v.pages[0].canvas),this._charAtlasDisposable.value=(0,g.getDisposeArrayDisposable)([(0,t.forwardEvent)(v.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,t.forwardEvent)(v.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=v,this._charAtlas.warmUp(),(h=this._glyphRenderer.value)===null||h===void 0||h.setAtlas(this._charAtlas)}_clearModel(h){var v;this._model.clear(),h&&((v=this._glyphRenderer.value)===null||v===void 0||v.clear())}clearTextureAtlas(){var h;(h=this._charAtlas)===null||h===void 0||h.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){var h;this._clearModel(!0);for(const v of this._renderLayers)v.reset(this._terminal);(h=this._cursorBlinkStateManager.value)===null||h===void 0||h.restartBlinkAnimation(),this._updateCursorBlink()}registerCharacterJoiner(h){return-1}deregisterCharacterJoiner(h){return!1}renderRows(h,v){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(const f of this._renderLayers)f.handleGridChanged(this._terminal,h,v);this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(h,v),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}_updateCursorBlink(){this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new p.CursorBlinkStateManager(()=>{this._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}_updateModel(h,v){const f=this._core;let b,y,w,M,D,T,z,B,H,G,q,$,j,W=this._workCell;h=n(h,f.rows-1,0),v=n(v,f.rows-1,0);const fe=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,se=Math.min(this._terminal.buffer.active.cursorX,f.cols-1);let le=-1;const ce=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;let ee=!1;for(y=h;y<=v;y++)for(w=y+f.buffer.ydisp,M=f.buffer.lines.get(w),this._model.lineLengths[y]=0,D=this._characterJoinerService.getJoinedCharacters(w),$=0;$<f.cols;$++)if(b=this._cellColorResolver.result.bg,M.loadCell($,W),$===0&&(b=this._cellColorResolver.result.bg),T=!1,z=$,D.length>0&&$===D[0][0]&&(T=!0,B=D.shift(),W=new s(W,M.translateToString(!0,B[0],B[1]),B[1]-B[0]),z=B[1]-1),H=W.getChars(),G=W.getCode(),q=(y*f.cols+$)*r.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(W,$,w),ce&&w===fe&&($===se&&(this._model.cursor={x:se,y:this._terminal.buffer.active.cursorY,width:W.getWidth(),style:this._coreBrowserService.isFocused?f.options.cursorStyle||"block":f.options.cursorInactiveStyle,cursorWidth:f.options.cursorWidth,dpr:this._devicePixelRatio},le=se+W.getWidth()-1),$>=se&&$<=le&&(this._coreBrowserService.isFocused&&(f.options.cursorStyle||"block")==="block"||this._coreBrowserService.isFocused===!1&&f.options.cursorInactiveStyle==="block")&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),G!==S.NULL_CELL_CODE&&(this._model.lineLengths[y]=$+1),(this._model.cells[q]!==G||this._model.cells[q+r.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[q+r.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[q+r.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(ee=!0,H.length>1&&(G|=r.COMBINED_CHAR_BIT_MASK),this._model.cells[q]=G,this._model.cells[q+r.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[q+r.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[q+r.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.value.updateCell($,y,G,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,H,b),T))for(W=this._workCell,$++;$<z;$++)j=(y*f.cols+$)*r.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell($,y,S.NULL_CELL_CODE,0,0,0,S.NULL_CELL_CHAR,0),this._model.cells[j]=S.NULL_CELL_CODE,this._model.cells[j+r.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[j+r.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[j+r.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;ee&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(h,v){this._canvas.width===h&&this._canvas.height===v||(this._canvas.width=h,this._canvas.height=v,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}_requestRedrawCursor(){const h=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:h,end:h})}}e.WebglRenderer=C,l([R.traceCall],C.prototype,"renderRows",null);class s extends L.AttributeData{constructor(h,v,f){super(),this.content=0,this.combinedData="",this.fg=h.fg,this.bg=h.bg,this.combinedData=v,this._width=f}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(h){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}function n(m,h,v=0){return Math.max(Math.min(m,h),v)}e.JoinedCellData=s},381:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GLTexture=e.expandFloat32Array=e.createShader=e.createProgram=e.PROJECTION_MATRIX=void 0;const l=d(374);function a(o,_,p){const c=(0,l.throwIfFalsy)(o.createShader(_));if(o.shaderSource(c,p),o.compileShader(c),o.getShaderParameter(c,o.COMPILE_STATUS))return c;console.error(o.getShaderInfoLog(c)),o.deleteShader(c)}e.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),e.createProgram=function(o,_,p){const c=(0,l.throwIfFalsy)(o.createProgram());if(o.attachShader(c,(0,l.throwIfFalsy)(a(o,o.VERTEX_SHADER,_))),o.attachShader(c,(0,l.throwIfFalsy)(a(o,o.FRAGMENT_SHADER,p))),o.linkProgram(c),o.getProgramParameter(c,o.LINK_STATUS))return c;console.error(o.getProgramInfoLog(c)),o.deleteProgram(c)},e.createShader=a,e.expandFloat32Array=function(o,_){const p=Math.min(2*o.length,_),c=new Float32Array(p);for(let i=0;i<o.length;i++)c[i]=o[i];return c},e.GLTexture=class{constructor(o){this.texture=o,this.version=-1}}},592:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseRenderLayer=void 0;const l=d(627),a=d(237),o=d(374),_=d(859);class p extends _.Disposable{constructor(i,t,g,L,x,S,R,A){super(),this._container=t,this._alpha=x,this._coreBrowserService=S,this._optionsService=R,this._themeService=A,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${g}-layer`),this._canvas.style.zIndex=L.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(E=>{this._refreshCharAtlas(i,E),this.reset(i)})),this.register((0,_.toDisposable)(()=>{this._canvas.remove()}))}_initCanvas(){this._ctx=(0,o.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(i){}handleFocus(i){}handleCursorMove(i){}handleGridChanged(i,t,g){}handleSelectionChanged(i,t,g,L=!1){}_setTransparency(i,t){if(t===this._alpha)return;const g=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,g),this._refreshCharAtlas(i,this._themeService.colors),this.handleGridChanged(i,0,i.rows-1)}_refreshCharAtlas(i,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,l.acquireTextureAtlas)(i,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(i,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width=`${t.css.canvas.width}px`,this._canvas.style.height=`${t.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(i,this._themeService.colors)}_fillBottomLineAtCells(i,t,g=1){this._ctx.fillRect(i*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,g*this._deviceCellWidth,this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(i,t,g,L){this._alpha?this._ctx.clearRect(i*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,L*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(i*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,L*this._deviceCellHeight))}_fillCharTrueColor(i,t,g,L){this._ctx.font=this._getFont(i,!1,!1),this._ctx.textBaseline=a.TEXT_BASELINE,this._clipCell(g,L,t.getWidth()),this._ctx.fillText(t.getChars(),g*this._deviceCellWidth+this._deviceCharLeft,L*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(i,t,g){this._ctx.beginPath(),this._ctx.rect(i*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(i,t,g){return`${g?"italic":""} ${t?i.options.fontWeightBold:i.options.fontWeight} ${i.options.fontSize*this._coreBrowserService.dpr}px ${i.options.fontFamily}`}}e.BaseRenderLayer=p},733:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkRenderLayer=void 0;const l=d(197),a=d(237),o=d(592);class _ extends o.BaseRenderLayer{constructor(c,i,t,g,L,x,S){super(t,c,"link",i,!0,L,x,S),this.register(g.onShowLinkUnderline(R=>this._handleShowLinkUnderline(R))),this.register(g.onHideLinkUnderline(R=>this._handleHideLinkUnderline(R)))}resize(c,i){super.resize(c,i),this._state=void 0}reset(c){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const c=this._state.y2-this._state.y1-1;c>0&&this._clearCells(0,this._state.y1+1,this._state.cols,c),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(c){if(c.fg===a.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:c.fg!==void 0&&(0,l.is256Color)(c.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[c.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,c.y1===c.y2)this._fillBottomLineAtCells(c.x1,c.y1,c.x2-c.x1);else{this._fillBottomLineAtCells(c.x1,c.y1,c.cols-c.x1);for(let i=c.y1+1;i<c.y2;i++)this._fillBottomLineAtCells(0,i,c.cols);this._fillBottomLineAtCells(0,c.y2,c.x2)}this._state=c}_handleHideLinkUnderline(c){this._clearCurrentLink()}}e.LinkRenderLayer=_},820:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(d,l,a,o){d.addEventListener(l,a,o);let _=!1;return{dispose:()=>{_||(_=!0,d.removeEventListener(l,a,o))}}}},274:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellColorResolver=void 0;let d,l=0,a=0,o=!1,_=!1,p=!1;e.CellColorResolver=class{constructor(c,i,t,g,L){this._terminal=c,this._selectionRenderModel=i,this._decorationService=t,this._coreBrowserService=g,this._themeService=L,this.result={fg:0,bg:0,ext:0}}resolve(c,i,t){this.result.bg=c.bg,this.result.fg=c.fg,this.result.ext=268435456&c.bg?c.extended.ext:0,a=0,l=0,_=!1,o=!1,p=!1,d=this._themeService.colors,this._decorationService.forEachDecorationAtCell(i,t,"bottom",g=>{g.backgroundColorRGB&&(a=g.backgroundColorRGB.rgba>>8&16777215,_=!0),g.foregroundColorRGB&&(l=g.foregroundColorRGB.rgba>>8&16777215,o=!0)}),p=this._selectionRenderModel.isCellSelected(this._terminal,i,t),p&&(a=(this._coreBrowserService.isFocused?d.selectionBackgroundOpaque:d.selectionInactiveBackgroundOpaque).rgba>>8&16777215,_=!0,d.selectionForeground&&(l=d.selectionForeground.rgba>>8&16777215,o=!0)),this._decorationService.forEachDecorationAtCell(i,t,"top",g=>{g.backgroundColorRGB&&(a=g.backgroundColorRGB.rgba>>8&16777215,_=!0),g.foregroundColorRGB&&(l=g.foregroundColorRGB.rgba>>8&16777215,o=!0)}),_&&(a=p?-16777216&c.bg&-134217729|a|50331648:-16777216&c.bg|a|50331648),o&&(l=-16777216&c.fg&-67108865|l|50331648),67108864&this.result.fg&&(_&&!o&&(l=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&d.background.rgba>>8|50331648,o=!0),!_&&o&&(a=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&d.foreground.rgba>>8|50331648,_=!0)),d=void 0,this.result.bg=_?a:this.result.bg,this.result.fg=o?l:this.result.fg}}},627:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeTerminalFromCache=e.acquireTextureAtlas=void 0;const l=d(509),a=d(197),o=[];e.acquireTextureAtlas=function(_,p,c,i,t,g,L,x){const S=(0,a.generateConfig)(i,t,g,L,p,c,x);for(let E=0;E<o.length;E++){const r=o[E],u=r.ownedBy.indexOf(_);if(u>=0){if((0,a.configEquals)(r.config,S))return r.atlas;r.ownedBy.length===1?(r.atlas.dispose(),o.splice(E,1)):r.ownedBy.splice(u,1);break}}for(let E=0;E<o.length;E++){const r=o[E];if((0,a.configEquals)(r.config,S))return r.ownedBy.push(_),r.atlas}const R=_._core,A={atlas:new l.TextureAtlas(document,S,R.unicodeService),config:S,ownedBy:[_]};return o.push(A),A.atlas},e.removeTerminalFromCache=function(_){for(let p=0;p<o.length;p++){const c=o[p].ownedBy.indexOf(_);if(c!==-1){o[p].ownedBy.length===1?(o[p].atlas.dispose(),o.splice(p,1)):o[p].ownedBy.splice(c,1);break}}}},197:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.is256Color=e.configEquals=e.generateConfig=void 0;const l=d(160);e.generateConfig=function(a,o,_,p,c,i,t){const g={foreground:i.foreground,background:i.background,cursor:l.NULL_COLOR,cursorAccent:l.NULL_COLOR,selectionForeground:l.NULL_COLOR,selectionBackgroundTransparent:l.NULL_COLOR,selectionBackgroundOpaque:l.NULL_COLOR,selectionInactiveBackgroundTransparent:l.NULL_COLOR,selectionInactiveBackgroundOpaque:l.NULL_COLOR,ansi:i.ansi.slice(),contrastCache:i.contrastCache,halfContrastCache:i.halfContrastCache};return{customGlyphs:c.customGlyphs,devicePixelRatio:t,letterSpacing:c.letterSpacing,lineHeight:c.lineHeight,deviceCellWidth:a,deviceCellHeight:o,deviceCharWidth:_,deviceCharHeight:p,fontFamily:c.fontFamily,fontSize:c.fontSize,fontWeight:c.fontWeight,fontWeightBold:c.fontWeightBold,allowTransparency:c.allowTransparency,drawBoldTextInBrightColors:c.drawBoldTextInBrightColors,minimumContrastRatio:c.minimumContrastRatio,colors:g}},e.configEquals=function(a,o){for(let _=0;_<a.colors.ansi.length;_++)if(a.colors.ansi[_].rgba!==o.colors.ansi[_].rgba)return!1;return a.devicePixelRatio===o.devicePixelRatio&&a.customGlyphs===o.customGlyphs&&a.lineHeight===o.lineHeight&&a.letterSpacing===o.letterSpacing&&a.fontFamily===o.fontFamily&&a.fontSize===o.fontSize&&a.fontWeight===o.fontWeight&&a.fontWeightBold===o.fontWeightBold&&a.allowTransparency===o.allowTransparency&&a.deviceCharWidth===o.deviceCharWidth&&a.deviceCharHeight===o.deviceCharHeight&&a.drawBoldTextInBrightColors===o.drawBoldTextInBrightColors&&a.minimumContrastRatio===o.minimumContrastRatio&&a.colors.foreground.rgba===o.colors.foreground.rgba&&a.colors.background.rgba===o.colors.background.rgba},e.is256Color=function(a){return(50331648&a)==16777216||(50331648&a)==33554432}},237:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;const l=d(399);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},457:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CursorBlinkStateManager=void 0,e.CursorBlinkStateManager=class{constructor(d,l){this._renderCallback=d,this._coreBrowserService=l,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(d=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const l=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,l>0)return void this._restartInterval(l)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const l=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(l)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},d)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},860:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tryDrawCustomChar=e.powerlineDefinitions=e.boxDrawingDefinitions=e.blockElementDefinitions=void 0;const l=d(374);e.blockElementDefinitions={"‚ñÄ":[{x:0,y:0,w:8,h:4}],"‚ñÅ":[{x:0,y:7,w:8,h:1}],"‚ñÇ":[{x:0,y:6,w:8,h:2}],"‚ñÉ":[{x:0,y:5,w:8,h:3}],"‚ñÑ":[{x:0,y:4,w:8,h:4}],"‚ñÖ":[{x:0,y:3,w:8,h:5}],"‚ñÜ":[{x:0,y:2,w:8,h:6}],"‚ñá":[{x:0,y:1,w:8,h:7}],"‚ñà":[{x:0,y:0,w:8,h:8}],"‚ñâ":[{x:0,y:0,w:7,h:8}],"‚ñä":[{x:0,y:0,w:6,h:8}],"‚ñã":[{x:0,y:0,w:5,h:8}],"‚ñå":[{x:0,y:0,w:4,h:8}],"‚ñç":[{x:0,y:0,w:3,h:8}],"‚ñé":[{x:0,y:0,w:2,h:8}],"‚ñè":[{x:0,y:0,w:1,h:8}],"‚ñê":[{x:4,y:0,w:4,h:8}],"‚ñî":[{x:0,y:0,w:8,h:1}],"‚ñï":[{x:7,y:0,w:1,h:8}],"‚ññ":[{x:0,y:4,w:4,h:4}],"‚ñó":[{x:4,y:4,w:4,h:4}],"‚ñò":[{x:0,y:0,w:4,h:4}],"‚ñô":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"‚ñö":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"‚ñõ":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"‚ñú":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"‚ñù":[{x:4,y:0,w:4,h:4}],"‚ñû":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"‚ñü":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"ü≠∞":[{x:1,y:0,w:1,h:8}],"ü≠±":[{x:2,y:0,w:1,h:8}],"ü≠≤":[{x:3,y:0,w:1,h:8}],"ü≠≥":[{x:4,y:0,w:1,h:8}],"ü≠¥":[{x:5,y:0,w:1,h:8}],"ü≠µ":[{x:6,y:0,w:1,h:8}],"ü≠∂":[{x:0,y:1,w:8,h:1}],"ü≠∑":[{x:0,y:2,w:8,h:1}],"ü≠∏":[{x:0,y:3,w:8,h:1}],"ü≠π":[{x:0,y:4,w:8,h:1}],"ü≠∫":[{x:0,y:5,w:8,h:1}],"ü≠ª":[{x:0,y:6,w:8,h:1}],"ü≠º":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"ü≠Ω":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ü≠æ":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"ü≠ø":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"üÆÄ":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"üÆÅ":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"üÆÇ":[{x:0,y:0,w:8,h:2}],"üÆÉ":[{x:0,y:0,w:8,h:3}],"üÆÑ":[{x:0,y:0,w:8,h:5}],"üÆÖ":[{x:0,y:0,w:8,h:6}],"üÆÜ":[{x:0,y:0,w:8,h:7}],"üÆá":[{x:6,y:0,w:2,h:8}],"üÆà":[{x:5,y:0,w:3,h:8}],"üÆâ":[{x:3,y:0,w:5,h:8}],"üÆä":[{x:2,y:0,w:6,h:8}],"üÆã":[{x:1,y:0,w:7,h:8}],"üÆï":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"üÆñ":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"üÆó":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const a={"‚ñë":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"‚ñí":[[1,0],[0,0],[0,1],[0,0]],"‚ñì":[[0,1],[1,1],[1,0],[1,1]]};e.boxDrawingDefinitions={"‚îÄ":{1:"M0,.5 L1,.5"},"‚îÅ":{3:"M0,.5 L1,.5"},"‚îÇ":{1:"M.5,0 L.5,1"},"‚îÉ":{3:"M.5,0 L.5,1"},"‚îå":{1:"M0.5,1 L.5,.5 L1,.5"},"‚îè":{3:"M0.5,1 L.5,.5 L1,.5"},"‚îê":{1:"M0,.5 L.5,.5 L.5,1"},"‚îì":{3:"M0,.5 L.5,.5 L.5,1"},"‚îî":{1:"M.5,0 L.5,.5 L1,.5"},"‚îó":{3:"M.5,0 L.5,.5 L1,.5"},"‚îò":{1:"M.5,0 L.5,.5 L0,.5"},"‚îõ":{3:"M.5,0 L.5,.5 L0,.5"},"‚îú":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"‚î£":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"‚î§":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"‚î´":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"‚î¨":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"‚î≥":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"‚î¥":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"‚îª":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"‚îº":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"‚ïã":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"‚ï¥":{1:"M.5,.5 L0,.5"},"‚ï∏":{3:"M.5,.5 L0,.5"},"‚ïµ":{1:"M.5,.5 L.5,0"},"‚ïπ":{3:"M.5,.5 L.5,0"},"‚ï∂":{1:"M.5,.5 L1,.5"},"‚ï∫":{3:"M.5,.5 L1,.5"},"‚ï∑":{1:"M.5,.5 L.5,1"},"‚ïª":{3:"M.5,.5 L.5,1"},"‚ïê":{1:(i,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"‚ïë":{1:(i,t)=>`M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"‚ïí":{1:(i,t)=>`M.5,1 L.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"‚ïì":{1:(i,t)=>`M${.5-i},1 L${.5-i},.5 L1,.5 M${.5+i},.5 L${.5+i},1`},"‚ïî":{1:(i,t)=>`M1,${.5-t} L${.5-i},${.5-t} L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1`},"‚ïï":{1:(i,t)=>`M0,${.5-t} L.5,${.5-t} L.5,1 M0,${.5+t} L.5,${.5+t}`},"‚ïñ":{1:(i,t)=>`M${.5+i},1 L${.5+i},.5 L0,.5 M${.5-i},.5 L${.5-i},1`},"‚ïó":{1:(i,t)=>`M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M0,${.5-t} L${.5+i},${.5-t} L${.5+i},1`},"‚ïò":{1:(i,t)=>`M.5,0 L.5,${.5+t} L1,${.5+t} M.5,${.5-t} L1,${.5-t}`},"‚ïô":{1:(i,t)=>`M1,.5 L${.5-i},.5 L${.5-i},0 M${.5+i},.5 L${.5+i},0`},"‚ïö":{1:(i,t)=>`M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0 M1,${.5+t} L${.5-i},${.5+t} L${.5-i},0`},"‚ïõ":{1:(i,t)=>`M0,${.5+t} L.5,${.5+t} L.5,0 M0,${.5-t} L.5,${.5-t}`},"‚ïú":{1:(i,t)=>`M0,.5 L${.5+i},.5 L${.5+i},0 M${.5-i},.5 L${.5-i},0`},"‚ïù":{1:(i,t)=>`M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0 M0,${.5+t} L${.5+i},${.5+t} L${.5+i},0`},"‚ïû":{1:(i,t)=>`M.5,0 L.5,1 M.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"‚ïü":{1:(i,t)=>`M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1 M${.5+i},.5 L1,.5`},"‚ï†":{1:(i,t)=>`M${.5-i},0 L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1 M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0`},"‚ï°":{1:(i,t)=>`M.5,0 L.5,1 M0,${.5-t} L.5,${.5-t} M0,${.5+t} L.5,${.5+t}`},"‚ï¢":{1:(i,t)=>`M0,.5 L${.5-i},.5 M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"‚ï£":{1:(i,t)=>`M${.5+i},0 L${.5+i},1 M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0`},"‚ï§":{1:(i,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t} M.5,${.5+t} L.5,1`},"‚ï•":{1:(i,t)=>`M0,.5 L1,.5 M${.5-i},.5 L${.5-i},1 M${.5+i},.5 L${.5+i},1`},"‚ï¶":{1:(i,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1`},"‚ïß":{1:(i,t)=>`M.5,0 L.5,${.5-t} M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"‚ï®":{1:(i,t)=>`M0,.5 L1,.5 M${.5-i},.5 L${.5-i},0 M${.5+i},.5 L${.5+i},0`},"‚ï©":{1:(i,t)=>`M0,${.5+t} L1,${.5+t} M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0 M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0`},"‚ï™":{1:(i,t)=>`M.5,0 L.5,1 M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"‚ï´":{1:(i,t)=>`M0,.5 L1,.5 M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"‚ï¨":{1:(i,t)=>`M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1 M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0 M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0`},"‚ï±":{1:"M1,0 L0,1"},"‚ï≤":{1:"M0,0 L1,1"},"‚ï≥":{1:"M1,0 L0,1 M0,0 L1,1"},"‚ïº":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"‚ïΩ":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"‚ïæ":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚ïø":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"‚îç":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"‚îé":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚îë":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"‚îí":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"‚îï":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"‚îñ":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"‚îô":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"‚îö":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"‚îù":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"‚îû":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"‚îü":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚î†":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"‚î°":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"‚î¢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"‚î•":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"‚î¶":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"‚îß":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"‚î®":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"‚î©":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"‚î™":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"‚î≠":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚îÆ":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"‚îØ":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"‚î∞":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚î±":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"‚î≤":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"‚îµ":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚î∂":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"‚î∑":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"‚î∏":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"‚îπ":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"‚î∫":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"‚îΩ":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"‚îæ":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"‚îø":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"‚ïÄ":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"‚ïÅ":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"‚ïÇ":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"‚ïÉ":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"‚ïÑ":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"‚ïÖ":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"‚ïÜ":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"‚ïá":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"‚ïà":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"‚ïâ":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"‚ïä":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"‚ïå":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"‚ïç":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"‚îÑ":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"‚îÖ":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"‚îà":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"‚îâ":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"‚ïé":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"‚ïè":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"‚îÜ":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"‚îá":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"‚îä":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"‚îã":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"‚ï≠":{1:(i,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,1,.5`},"‚ïÆ":{1:(i,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,0,.5`},"‚ïØ":{1:(i,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,0,.5`},"‚ï∞":{1:(i,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,1,.5`}},e.powerlineDefinitions={"ÓÇ∞":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"ÓÇ±":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇ≤":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"ÓÇ≥":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇ¥":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"ÓÇµ":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"ÓÇ∂":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"ÓÇ∑":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"ÓÇ∏":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"ÓÇπ":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇ∫":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"ÓÇº":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"ÓÇΩ":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"ÓÇæ":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},e.powerlineDefinitions["ÓÇª"]=e.powerlineDefinitions["ÓÇΩ"],e.powerlineDefinitions["ÓÇø"]=e.powerlineDefinitions["ÓÇπ"],e.tryDrawCustomChar=function(i,t,g,L,x,S,R,A){const E=e.blockElementDefinitions[t];if(E)return function(s,n,m,h,v,f){for(let b=0;b<n.length;b++){const y=n[b],w=v/8,M=f/8;s.fillRect(m+y.x*w,h+y.y*M,y.w*w,y.h*M)}}(i,E,g,L,x,S),!0;const r=a[t];if(r)return function(s,n,m,h,v,f){let b=o.get(n);b||(b=new Map,o.set(n,b));const y=s.fillStyle;if(typeof y!="string")throw new Error(`Unexpected fillStyle type "${y}"`);let w=b.get(y);if(!w){const M=n[0].length,D=n.length,T=document.createElement("canvas");T.width=M,T.height=D;const z=(0,l.throwIfFalsy)(T.getContext("2d")),B=new ImageData(M,D);let H,G,q,$;if(y.startsWith("#"))H=parseInt(y.slice(1,3),16),G=parseInt(y.slice(3,5),16),q=parseInt(y.slice(5,7),16),$=y.length>7&&parseInt(y.slice(7,9),16)||1;else{if(!y.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${y}" when drawing pattern glyph`);[H,G,q,$]=y.substring(5,y.length-1).split(",").map(j=>parseFloat(j))}for(let j=0;j<D;j++)for(let W=0;W<M;W++)B.data[4*(j*M+W)]=H,B.data[4*(j*M+W)+1]=G,B.data[4*(j*M+W)+2]=q,B.data[4*(j*M+W)+3]=n[j][W]*(255*$);z.putImageData(B,0,0),w=(0,l.throwIfFalsy)(s.createPattern(T,null)),b.set(y,w)}s.fillStyle=w,s.fillRect(m,h,v,f)}(i,r,g,L,x,S),!0;const u=e.boxDrawingDefinitions[t];if(u)return function(s,n,m,h,v,f,b){s.strokeStyle=s.fillStyle;for(const[y,w]of Object.entries(n)){let M;s.beginPath(),s.lineWidth=b*Number.parseInt(y),M=typeof w=="function"?w(.15,.15/f*v):w;for(const D of M.split(" ")){const T=D[0],z=p[T];if(!z){console.error(`Could not find drawing instructions for "${T}"`);continue}const B=D.substring(1).split(",");B[0]&&B[1]&&z(s,c(B,v,f,m,h,!0,b))}s.stroke(),s.closePath()}}(i,u,g,L,x,S,A),!0;const C=e.powerlineDefinitions[t];return!!C&&(function(s,n,m,h,v,f,b,y){var w,M;const D=new Path2D;D.rect(m,h,v,f),s.clip(D),s.beginPath();const T=b/12;s.lineWidth=y*T;for(const z of n.d.split(" ")){const B=z[0],H=p[B];if(!H){console.error(`Could not find drawing instructions for "${B}"`);continue}const G=z.substring(1).split(",");G[0]&&G[1]&&H(s,c(G,v,f,m,h,!1,y,((w=n.leftPadding)!==null&&w!==void 0?w:0)*(T/2),((M=n.rightPadding)!==null&&M!==void 0?M:0)*(T/2)))}n.type===1?(s.strokeStyle=s.fillStyle,s.stroke()):s.fill(),s.closePath()}(i,C,g,L,x,S,R,A),!0)};const o=new Map;function _(i,t,g=0){return Math.max(Math.min(i,t),g)}const p={C:(i,t)=>i.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]),L:(i,t)=>i.lineTo(t[0],t[1]),M:(i,t)=>i.moveTo(t[0],t[1])};function c(i,t,g,L,x,S,R,A=0,E=0){const r=i.map(u=>parseFloat(u)||parseInt(u));if(r.length<2)throw new Error("Too few arguments for instruction");for(let u=0;u<r.length;u+=2)r[u]*=t-A*R-E*R,S&&r[u]!==0&&(r[u]=_(Math.round(r[u]+.5)-.5,t,0)),r[u]+=L+A*R;for(let u=1;u<r.length;u+=2)r[u]*=g,S&&r[u]!==0&&(r[u]=_(Math.round(r[u]+.5)-.5,g,0)),r[u]+=x;return r}},56:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.observeDevicePixelDimensions=void 0;const l=d(859);e.observeDevicePixelDimensions=function(a,o,_){let p=new o.ResizeObserver(c=>{const i=c.find(L=>L.target===a);if(!i)return;if(!("devicePixelContentBoxSize"in i))return p==null||p.disconnect(),void(p=void 0);const t=i.devicePixelContentBoxSize[0].inlineSize,g=i.devicePixelContentBoxSize[0].blockSize;t>0&&g>0&&_(t,g)});try{p.observe(a,{box:["device-pixel-content-box"]})}catch{p.disconnect(),p=void 0}return(0,l.toDisposable)(()=>p==null?void 0:p.disconnect())}},374:(F,e)=>{function d(l){return 57508<=l&&l<=57558}Object.defineProperty(e,"__esModule",{value:!0}),e.createRenderDimensions=e.excludeFromContrastRatioDemands=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},e.isPowerlineGlyph=d,e.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},e.excludeFromContrastRatioDemands=function(l){return d(l)||function(a){return 9472<=a&&a<=9631}(l)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createSelectionRenderModel=void 0;class d{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(a,o,_,p=!1){if(this.selectionStart=o,this.selectionEnd=_,!o||!_||o[0]===_[0]&&o[1]===_[1])return void this.clear();const c=o[1]-a.buffer.active.viewportY,i=_[1]-a.buffer.active.viewportY,t=Math.max(c,0),g=Math.min(i,a.rows-1);t>=a.rows||g<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=p,this.viewportStartRow=c,this.viewportEndRow=i,this.viewportCappedStartRow=t,this.viewportCappedEndRow=g,this.startCol=o[0],this.endCol=_[0])}isCellSelected(a,o,_){return!!this.hasSelection&&(_-=a.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?o>=this.startCol&&_>=this.viewportCappedStartRow&&o<this.endCol&&_<=this.viewportCappedEndRow:o<this.startCol&&_>=this.viewportCappedStartRow&&o>=this.endCol&&_<=this.viewportCappedEndRow:_>this.viewportStartRow&&_<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&_===this.viewportStartRow&&o>=this.startCol&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportEndRow&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportStartRow&&o>=this.startCol)}}e.createSelectionRenderModel=function(){return new d}},509:function(F,e,d){var l=this&&this.__decorate||function(C,s,n,m){var h,v=arguments.length,f=v<3?s:m===null?m=Object.getOwnPropertyDescriptor(s,n):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(C,s,n,m);else for(var b=C.length-1;b>=0;b--)(h=C[b])&&(f=(v<3?h(f):v>3?h(s,n,f):h(s,n))||f);return v>3&&f&&Object.defineProperty(s,n,f),f};Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAtlas=void 0;const a=d(237),o=d(860),_=d(374),p=d(160),c=d(345),i=d(485),t=d(385),g=d(147),L=d(855),x=d(776),S={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let R;class A{get pages(){return this._pages}constructor(s,n,m){this._document=s,this._config=n,this._unicodeService=m,this._didWarmUp=!1,this._cacheMap=new i.FourKeyMap,this._cacheMapCombined=new i.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new g.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new c.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new c.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=u(s,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,_.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}dispose(){for(const s of this.pages)s.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const s=new t.IdleTaskQueue;for(let n=33;n<126;n++)s.enqueue(()=>{if(!this._cacheMap.get(n,L.DEFAULT_COLOR,L.DEFAULT_COLOR,L.DEFAULT_EXT)){const m=this._drawToCache(n,L.DEFAULT_COLOR,L.DEFAULT_COLOR,L.DEFAULT_EXT);this._cacheMap.set(n,L.DEFAULT_COLOR,L.DEFAULT_COLOR,L.DEFAULT_EXT,m)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const s of this._pages)s.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){if(A.maxAtlasPages&&this._pages.length>=Math.max(4,A.maxAtlasPages)){const n=this._pages.filter(w=>2*w.canvas.width<=(A.maxTextureSize||4096)).sort((w,M)=>M.canvas.width!==w.canvas.width?M.canvas.width-w.canvas.width:M.percentageUsed-w.percentageUsed);let m=-1,h=0;for(let w=0;w<n.length;w++)if(n[w].canvas.width!==h)m=w,h=n[w].canvas.width;else if(w-m==3)break;const v=n.slice(m,m+4),f=v.map(w=>w.glyphs[0].texturePage).sort((w,M)=>w>M?1:-1),b=this.pages.length-v.length,y=this._mergePages(v,b);y.version++;for(let w=f.length-1;w>=0;w--)this._deletePage(f[w]);this.pages.push(y),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(y.canvas)}const s=new E(this._document,this._textureSize);return this._pages.push(s),this._activePages.push(s),this._onAddTextureAtlasCanvas.fire(s.canvas),s}_mergePages(s,n){const m=2*s[0].canvas.width,h=new E(this._document,m,s);for(const[v,f]of s.entries()){const b=v*f.canvas.width%m,y=Math.floor(v/2)*f.canvas.height;h.ctx.drawImage(f.canvas,b,y);for(const M of f.glyphs)M.texturePage=n,M.sizeClipSpace.x=M.size.x/m,M.sizeClipSpace.y=M.size.y/m,M.texturePosition.x+=b,M.texturePosition.y+=y,M.texturePositionClipSpace.x=M.texturePosition.x/m,M.texturePositionClipSpace.y=M.texturePosition.y/m;this._onRemoveTextureAtlasCanvas.fire(f.canvas);const w=this._activePages.indexOf(f);w!==-1&&this._activePages.splice(w,1)}return h}_deletePage(s){this._pages.splice(s,1);for(let n=s;n<this._pages.length;n++){const m=this._pages[n];for(const h of m.glyphs)h.texturePage--;m.version++}}getRasterizedGlyphCombinedChar(s,n,m,h,v){return this._getFromCacheMap(this._cacheMapCombined,s,n,m,h,v)}getRasterizedGlyph(s,n,m,h,v){return this._getFromCacheMap(this._cacheMap,s,n,m,h,v)}_getFromCacheMap(s,n,m,h,v,f=!1){return R=s.get(n,m,h,v),R||(R=this._drawToCache(n,m,h,v,f),s.set(n,m,h,v,R)),R}_getColorFromAnsiIndex(s){if(s>=this._config.colors.ansi.length)throw new Error("No color found for idx "+s);return this._config.colors.ansi[s]}_getBackgroundColor(s,n,m,h){if(this._config.allowTransparency)return p.NULL_COLOR;let v;switch(s){case 16777216:case 33554432:v=this._getColorFromAnsiIndex(n);break;case 50331648:const f=g.AttributeData.toColorRGB(n);v=p.rgba.toColor(f[0],f[1],f[2]);break;default:v=m?p.color.opaque(this._config.colors.foreground):this._config.colors.background}return v}_getForegroundColor(s,n,m,h,v,f,b,y,w,M){const D=this._getMinimumContrastColor(s,n,m,h,v,f,!1,w,y,M);if(D)return D;let T;switch(v){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&w&&f<8&&(f+=8),T=this._getColorFromAnsiIndex(f);break;case 50331648:const z=g.AttributeData.toColorRGB(f);T=p.rgba.toColor(z[0],z[1],z[2]);break;default:T=b?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(T=p.color.opaque(T)),y&&(T=p.color.multiplyOpacity(T,a.DIM_OPACITY)),T}_resolveBackgroundRgba(s,n,m){switch(s){case 16777216:case 33554432:return this._getColorFromAnsiIndex(n).rgba;case 50331648:return n<<8;default:return m?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(s,n,m,h){switch(s){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&h&&n<8&&(n+=8),this._getColorFromAnsiIndex(n).rgba;case 50331648:return n<<8;default:return m?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(s,n,m,h,v,f,b,y,w,M){if(this._config.minimumContrastRatio===1||M)return;const D=this._getContrastCache(w),T=D.getColor(s,h);if(T!==void 0)return T||void 0;const z=this._resolveBackgroundRgba(n,m,b),B=this._resolveForegroundRgba(v,f,b,y),H=p.rgba.ensureContrastRatio(z,B,this._config.minimumContrastRatio/(w?2:1));if(!H)return void D.setColor(s,h,null);const G=p.rgba.toColor(H>>24&255,H>>16&255,H>>8&255);return D.setColor(s,h,G),G}_getContrastCache(s){return s?this._config.colors.halfContrastCache:this._config.colors.contrastCache}_drawToCache(s,n,m,h,v=!1){const f=typeof s=="number"?String.fromCharCode(s):s,b=Math.min(this._config.deviceCellWidth*Math.max(f.length,2)+4,this._textureSize);this._tmpCanvas.width<b&&(this._tmpCanvas.width=b);const y=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<y&&(this._tmpCanvas.height=y),this._tmpCtx.save(),this._workAttributeData.fg=m,this._workAttributeData.bg=n,this._workAttributeData.extended.ext=h,this._workAttributeData.isInvisible())return S;const w=!!this._workAttributeData.isBold(),M=!!this._workAttributeData.isInverse(),D=!!this._workAttributeData.isDim(),T=!!this._workAttributeData.isItalic(),z=!!this._workAttributeData.isUnderline(),B=!!this._workAttributeData.isStrikethrough(),H=!!this._workAttributeData.isOverline();let G=this._workAttributeData.getFgColor(),q=this._workAttributeData.getFgColorMode(),$=this._workAttributeData.getBgColor(),j=this._workAttributeData.getBgColorMode();if(M){const P=G;G=$,$=P;const U=q;q=j,j=U}const W=this._getBackgroundColor(j,$,M,D);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=W.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const fe=w?this._config.fontWeightBold:this._config.fontWeight,se=T?"italic":"";this._tmpCtx.font=`${se} ${fe} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=a.TEXT_BASELINE;const le=f.length===1&&(0,_.isPowerlineGlyph)(f.charCodeAt(0)),ce=f.length===1&&(0,_.isRestrictedPowerlineGlyph)(f.charCodeAt(0)),ee=this._getForegroundColor(n,j,$,m,q,G,M,D,w,(0,_.excludeFromContrastRatioDemands)(f.charCodeAt(0)));this._tmpCtx.fillStyle=ee.css;const N=ce?0:4;let de=!1;this._config.customGlyphs!==!1&&(de=(0,o.tryDrawCustomChar)(this._tmpCtx,f,N,N,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let oe,ne=!le;if(oe=typeof s=="number"?this._unicodeService.wcwidth(s):this._unicodeService.getStringCellWidth(s),z){this._tmpCtx.save();const P=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),U=P%2==1?.5:0;if(this._tmpCtx.lineWidth=P,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())ne=!1,this._tmpCtx.strokeStyle=`rgb(${g.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{ne=!1;let K=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&K<8&&(K+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(K).css}this._tmpCtx.beginPath();const J=N,X=Math.ceil(N+this._config.deviceCharHeight)-U-(v?2*P:0),ae=X+P,he=X+2*P;for(let K=0;K<oe;K++){this._tmpCtx.save();const V=J+K*this._config.deviceCellWidth,Z=J+(K+1)*this._config.deviceCellWidth,pe=V+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(V,X),this._tmpCtx.lineTo(Z,X),this._tmpCtx.moveTo(V,he),this._tmpCtx.lineTo(Z,he);break;case 3:const ue=P<=1?he:Math.ceil(N+this._config.deviceCharHeight-P/2)-U,ge=P<=1?X:Math.ceil(N+this._config.deviceCharHeight+P/2)-U,me=new Path2D;me.rect(V,X,this._config.deviceCellWidth,he-X),this._tmpCtx.clip(me),this._tmpCtx.moveTo(V-this._config.deviceCellWidth/2,ae),this._tmpCtx.bezierCurveTo(V-this._config.deviceCellWidth/2,ge,V,ge,V,ae),this._tmpCtx.bezierCurveTo(V,ue,pe,ue,pe,ae),this._tmpCtx.bezierCurveTo(pe,ge,Z,ge,Z,ae),this._tmpCtx.bezierCurveTo(Z,ue,Z+this._config.deviceCellWidth/2,ue,Z+this._config.deviceCellWidth/2,ae);break;case 4:this._tmpCtx.setLineDash([Math.round(P),Math.round(P)]),this._tmpCtx.moveTo(V,X),this._tmpCtx.lineTo(Z,X);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(V,X),this._tmpCtx.lineTo(Z,X);break;default:this._tmpCtx.moveTo(V,X),this._tmpCtx.lineTo(Z,X)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!de&&this._config.fontSize>=12&&!this._config.allowTransparency&&f!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const K=this._tmpCtx.measureText(f);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in K&&K.actualBoundingBoxDescent>0){this._tmpCtx.save();const V=new Path2D;V.rect(J,X-Math.ceil(P/2),this._config.deviceCellWidth*oe,he-X+Math.ceil(P/2)),this._tmpCtx.clip(V),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=W.css,this._tmpCtx.strokeText(f,N,N+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(H){const P=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),U=P%2==1?.5:0;this._tmpCtx.lineWidth=P,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(N,N+U),this._tmpCtx.lineTo(N+this._config.deviceCharWidth*oe,N+U),this._tmpCtx.stroke()}if(de||this._tmpCtx.fillText(f,N,N+this._config.deviceCharHeight),f==="_"&&!this._config.allowTransparency){let P=r(this._tmpCtx.getImageData(N,N,this._config.deviceCellWidth,this._config.deviceCellHeight),W,ee,ne);if(P)for(let U=1;U<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=W.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(f,N,N+this._config.deviceCharHeight-U),P=r(this._tmpCtx.getImageData(N,N,this._config.deviceCellWidth,this._config.deviceCellHeight),W,ee,ne),P);U++);}if(B){const P=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),U=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=P,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(N,N+Math.floor(this._config.deviceCharHeight/2)-U),this._tmpCtx.lineTo(N+this._config.deviceCharWidth*oe,N+Math.floor(this._config.deviceCharHeight/2)-U),this._tmpCtx.stroke()}this._tmpCtx.restore();const _e=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let Ce;if(Ce=this._config.allowTransparency?function(P){for(let U=0;U<P.data.length;U+=4)if(P.data[U+3]>0)return!1;return!0}(_e):r(_e,W,ee,ne),Ce)return S;const k=this._findGlyphBoundingBox(_e,this._workBoundingBox,b,ce,de,N);let I,O;for(;;){if(this._activePages.length===0){const P=this._createNewPage();I=P,O=P.currentRow,O.height=k.size.y;break}I=this._activePages[this._activePages.length-1],O=I.currentRow;for(const P of this._activePages)k.size.y<=P.currentRow.height&&(I=P,O=P.currentRow);for(let P=this._activePages.length-1;P>=0;P--)for(const U of this._activePages[P].fixedRows)U.height<=O.height&&k.size.y<=U.height&&(I=this._activePages[P],O=U);if(O.y+k.size.y>=I.canvas.height||O.height>k.size.y+2){let P=!1;if(I.currentRow.y+I.currentRow.height+k.size.y>=I.canvas.height){let U;for(const J of this._activePages)if(J.currentRow.y+J.currentRow.height+k.size.y<J.canvas.height){U=J;break}if(U)I=U;else if(A.maxAtlasPages&&this._pages.length>=A.maxAtlasPages&&O.y+k.size.y<=I.canvas.height&&O.height>=k.size.y&&O.x+k.size.x<=I.canvas.width)P=!0;else{const J=this._createNewPage();I=J,O=J.currentRow,O.height=k.size.y,P=!0}}P||(I.currentRow.height>0&&I.fixedRows.push(I.currentRow),O={x:0,y:I.currentRow.y+I.currentRow.height,height:k.size.y},I.fixedRows.push(O),I.currentRow={x:0,y:O.y+O.height,height:0})}if(O.x+k.size.x<=I.canvas.width)break;O===I.currentRow?(O.x=0,O.y+=O.height,O.height=0):I.fixedRows.splice(I.fixedRows.indexOf(O),1)}return k.texturePage=this._pages.indexOf(I),k.texturePosition.x=O.x,k.texturePosition.y=O.y,k.texturePositionClipSpace.x=O.x/I.canvas.width,k.texturePositionClipSpace.y=O.y/I.canvas.height,k.sizeClipSpace.x/=I.canvas.width,k.sizeClipSpace.y/=I.canvas.height,O.height=Math.max(O.height,k.size.y),O.x+=k.size.x,I.ctx.putImageData(_e,k.texturePosition.x-this._workBoundingBox.left,k.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,k.size.x,k.size.y),I.addGlyph(k),I.version++,k}_findGlyphBoundingBox(s,n,m,h,v,f){n.top=0;const b=h?this._config.deviceCellHeight:this._tmpCanvas.height,y=h?this._config.deviceCellWidth:m;let w=!1;for(let M=0;M<b;M++){for(let D=0;D<y;D++){const T=M*this._tmpCanvas.width*4+4*D+3;if(s.data[T]!==0){n.top=M,w=!0;break}}if(w)break}n.left=0,w=!1;for(let M=0;M<f+y;M++){for(let D=0;D<b;D++){const T=D*this._tmpCanvas.width*4+4*M+3;if(s.data[T]!==0){n.left=M,w=!0;break}}if(w)break}n.right=y,w=!1;for(let M=f+y-1;M>=f;M--){for(let D=0;D<b;D++){const T=D*this._tmpCanvas.width*4+4*M+3;if(s.data[T]!==0){n.right=M,w=!0;break}}if(w)break}n.bottom=b,w=!1;for(let M=b-1;M>=0;M--){for(let D=0;D<y;D++){const T=M*this._tmpCanvas.width*4+4*D+3;if(s.data[T]!==0){n.bottom=M,w=!0;break}}if(w)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:n.right-n.left+1,y:n.bottom-n.top+1},sizeClipSpace:{x:n.right-n.left+1,y:n.bottom-n.top+1},offset:{x:-n.left+f+(h||v?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-n.top+f+(h||v?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}e.TextureAtlas=A,l([x.traceCall],A.prototype,"_drawToCache",null);class E{get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(s){this._glyphs.push(s),this._usedPixels+=s.size.x*s.size.y}constructor(s,n,m){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],m)for(const h of m)this._glyphs.push(...h.glyphs),this._usedPixels+=h._usedPixels;this.canvas=u(s,n,n),this.ctx=(0,_.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function r(C,s,n,m){const h=s.rgba>>>24,v=s.rgba>>>16&255,f=s.rgba>>>8&255,b=n.rgba>>>24,y=n.rgba>>>16&255,w=n.rgba>>>8&255,M=Math.floor((Math.abs(h-b)+Math.abs(v-y)+Math.abs(f-w))/12);let D=!0;for(let T=0;T<C.data.length;T+=4)C.data[T]===h&&C.data[T+1]===v&&C.data[T+2]===f||m&&Math.abs(C.data[T]-h)+Math.abs(C.data[T+1]-v)+Math.abs(C.data[T+2]-f)<M?C.data[T+3]=0:D=!1;return D}function u(C,s,n){const m=C.createElement("canvas");return m.width=s,m.height=n,m}},160:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;const l=d(399);let a=0,o=0,_=0,p=0;var c,i,t,g,L;function x(R){const A=R.toString(16);return A.length<2?"0"+A:A}function S(R,A){return R<A?(A+.05)/(R+.05):(R+.05)/(A+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(R){R.toCss=function(A,E,r,u){return u!==void 0?`#${x(A)}${x(E)}${x(r)}${x(u)}`:`#${x(A)}${x(E)}${x(r)}`},R.toRgba=function(A,E,r,u=255){return(A<<24|E<<16|r<<8|u)>>>0}}(c||(e.channels=c={})),function(R){function A(E,r){return p=Math.round(255*r),[a,o,_]=L.toChannels(E.rgba),{css:c.toCss(a,o,_,p),rgba:c.toRgba(a,o,_,p)}}R.blend=function(E,r){if(p=(255&r.rgba)/255,p===1)return{css:r.css,rgba:r.rgba};const u=r.rgba>>24&255,C=r.rgba>>16&255,s=r.rgba>>8&255,n=E.rgba>>24&255,m=E.rgba>>16&255,h=E.rgba>>8&255;return a=n+Math.round((u-n)*p),o=m+Math.round((C-m)*p),_=h+Math.round((s-h)*p),{css:c.toCss(a,o,_),rgba:c.toRgba(a,o,_)}},R.isOpaque=function(E){return(255&E.rgba)==255},R.ensureContrastRatio=function(E,r,u){const C=L.ensureContrastRatio(E.rgba,r.rgba,u);if(C)return L.toColor(C>>24&255,C>>16&255,C>>8&255)},R.opaque=function(E){const r=(255|E.rgba)>>>0;return[a,o,_]=L.toChannels(r),{css:c.toCss(a,o,_),rgba:r}},R.opacity=A,R.multiplyOpacity=function(E,r){return p=255&E.rgba,A(E,p*r/255)},R.toColorRGB=function(E){return[E.rgba>>24&255,E.rgba>>16&255,E.rgba>>8&255]}}(i||(e.color=i={})),function(R){let A,E;if(!l.isNode){const r=document.createElement("canvas");r.width=1,r.height=1;const u=r.getContext("2d",{willReadFrequently:!0});u&&(A=u,A.globalCompositeOperation="copy",E=A.createLinearGradient(0,0,1,1))}R.toColor=function(r){if(r.match(/#[\da-f]{3,8}/i))switch(r.length){case 4:return a=parseInt(r.slice(1,2).repeat(2),16),o=parseInt(r.slice(2,3).repeat(2),16),_=parseInt(r.slice(3,4).repeat(2),16),L.toColor(a,o,_);case 5:return a=parseInt(r.slice(1,2).repeat(2),16),o=parseInt(r.slice(2,3).repeat(2),16),_=parseInt(r.slice(3,4).repeat(2),16),p=parseInt(r.slice(4,5).repeat(2),16),L.toColor(a,o,_,p);case 7:return{css:r,rgba:(parseInt(r.slice(1),16)<<8|255)>>>0};case 9:return{css:r,rgba:parseInt(r.slice(1),16)>>>0}}const u=r.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(u)return a=parseInt(u[1]),o=parseInt(u[2]),_=parseInt(u[3]),p=Math.round(255*(u[5]===void 0?1:parseFloat(u[5]))),L.toColor(a,o,_,p);if(!A||!E)throw new Error("css.toColor: Unsupported css format");if(A.fillStyle=E,A.fillStyle=r,typeof A.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(A.fillRect(0,0,1,1),[a,o,_,p]=A.getImageData(0,0,1,1).data,p!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:c.toRgba(a,o,_,p),css:r}}}(t||(e.css=t={})),function(R){function A(E,r,u){const C=E/255,s=r/255,n=u/255;return .2126*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))}R.relativeLuminance=function(E){return A(E>>16&255,E>>8&255,255&E)},R.relativeLuminance2=A}(g||(e.rgb=g={})),function(R){function A(r,u,C){const s=r>>24&255,n=r>>16&255,m=r>>8&255;let h=u>>24&255,v=u>>16&255,f=u>>8&255,b=S(g.relativeLuminance2(h,v,f),g.relativeLuminance2(s,n,m));for(;b<C&&(h>0||v>0||f>0);)h-=Math.max(0,Math.ceil(.1*h)),v-=Math.max(0,Math.ceil(.1*v)),f-=Math.max(0,Math.ceil(.1*f)),b=S(g.relativeLuminance2(h,v,f),g.relativeLuminance2(s,n,m));return(h<<24|v<<16|f<<8|255)>>>0}function E(r,u,C){const s=r>>24&255,n=r>>16&255,m=r>>8&255;let h=u>>24&255,v=u>>16&255,f=u>>8&255,b=S(g.relativeLuminance2(h,v,f),g.relativeLuminance2(s,n,m));for(;b<C&&(h<255||v<255||f<255);)h=Math.min(255,h+Math.ceil(.1*(255-h))),v=Math.min(255,v+Math.ceil(.1*(255-v))),f=Math.min(255,f+Math.ceil(.1*(255-f))),b=S(g.relativeLuminance2(h,v,f),g.relativeLuminance2(s,n,m));return(h<<24|v<<16|f<<8|255)>>>0}R.ensureContrastRatio=function(r,u,C){const s=g.relativeLuminance(r>>8),n=g.relativeLuminance(u>>8);if(S(s,n)<C){if(n<s){const v=A(r,u,C),f=S(s,g.relativeLuminance(v>>8));if(f<C){const b=E(r,u,C);return f>S(s,g.relativeLuminance(b>>8))?v:b}return v}const m=E(r,u,C),h=S(s,g.relativeLuminance(m>>8));if(h<C){const v=A(r,u,C);return h>S(s,g.relativeLuminance(v>>8))?m:v}return m}},R.reduceLuminance=A,R.increaseLuminance=E,R.toChannels=function(r){return[r>>24&255,r>>16&255,r>>8&255,255&r]},R.toColor=function(r,u,C,s){return{css:c.toCss(r,u,C,s),rgba:c.toRgba(r,u,C,s)}}}(L||(e.rgba=L={})),e.toPaddedHex=x,e.contrastRatio=S},345:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=d=>(this._listeners.push(d),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===d)return void this._listeners.splice(l,1)}}})),this._event}fire(d,l){const a=[];for(let o=0;o<this._listeners.length;o++)a.push(this._listeners[o]);for(let o=0;o<a.length;o++)a[o].call(void 0,d,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},e.forwardEvent=function(d,l){return d(a=>l.fire(a))}},859:(F,e)=>{function d(l){for(const a of l)a.dispose();l.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.MutableDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const a=this._disposables.indexOf(l);a!==-1&&this._disposables.splice(a,1)}},e.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){var a;this._isDisposed||l===this._value||((a=this._value)===null||a===void 0||a.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){var l;this._isDisposed=!0,(l=this._value)===null||l===void 0||l.dispose(),this._value=void 0}},e.toDisposable=function(l){return{dispose:l}},e.disposeArray=d,e.getDisposeArrayDisposable=function(l){return{dispose:()=>d(l)}}},485:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class d{constructor(){this._data={}}set(a,o,_){this._data[a]||(this._data[a]={}),this._data[a][o]=_}get(a,o){return this._data[a]?this._data[a][o]:void 0}clear(){this._data={}}}e.TwoKeyMap=d,e.FourKeyMap=class{constructor(){this._data=new d}set(l,a,o,_,p){this._data.get(l,a)||this._data.set(l,a,new d),this._data.get(l,a).set(o,_,p)}get(l,a,o,_){var p;return(p=this._data.get(l,a))===null||p===void 0?void 0:p.get(o,_)}clear(){this._data.clear()}}},399:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof navigator>"u";const d=e.isNode?"node":navigator.userAgent,l=e.isNode?"node":navigator.platform;e.isFirefox=d.includes("Firefox"),e.isLegacyEdge=d.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(d),e.getSafariVersion=function(){if(!e.isSafari)return 0;const a=d.match(/Version\/(\d+)/);return a===null||a.length<2?0:parseInt(a[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),e.isIpad=l==="iPad",e.isIphone=l==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),e.isLinux=l.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(d)},385:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;const l=d(399);class a{constructor(){this._tasks=[],this._i=0}enqueue(p){this._tasks.push(p),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(p){this._idleCallback=void 0;let c=0,i=0,t=p.timeRemaining(),g=0;for(;this._i<this._tasks.length;){if(c=Date.now(),this._tasks[this._i]()||this._i++,c=Math.max(1,Date.now()-c),i=Math.max(c,i),g=p.timeRemaining(),1.5*i>g)return t-c<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-c))}ms`),void this._start();t=g}this.clear()}}class o extends a{_requestCallback(p){return setTimeout(()=>p(this._createDeadline(16)))}_cancelCallback(p){clearTimeout(p)}_createDeadline(p){const c=Date.now()+p;return{timeRemaining:()=>Math.max(0,c-Date.now())}}}e.PriorityTaskQueue=o,e.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends a{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:o,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},147:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class d{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(o){return[o>>>16&255,o>>>8&255,255&o]}static fromColorRGB(o){return(255&o[0])<<16|(255&o[1])<<8|255&o[2]}clone(){const o=new d;return o.fg=this.fg,o.bg=this.bg,o.extended=this.extended.clone(),o}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}e.AttributeData=d;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(o){this._ext=o}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(o){this._ext&=-469762049,this._ext|=o<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(o){this._ext&=-67108864,this._ext|=67108863&o}get urlId(){return this._urlId}set urlId(o){this._urlId=o}constructor(o=0,_=0){this._ext=0,this._urlId=0,this._ext=o,this._urlId=_}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=l},782:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;const l=d(133),a=d(855),o=d(147);class _ extends o.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new o.ExtendedAttrs,this.combinedData=""}static fromCharData(c){const i=new _;return i.setFromCharData(c),i}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(c){this.fg=c[a.CHAR_DATA_ATTR_INDEX],this.bg=0;let i=!1;if(c[a.CHAR_DATA_CHAR_INDEX].length>2)i=!0;else if(c[a.CHAR_DATA_CHAR_INDEX].length===2){const t=c[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const g=c[a.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=g&&g<=57343?this.content=1024*(t-55296)+g-56320+65536|c[a.CHAR_DATA_WIDTH_INDEX]<<22:i=!0}else i=!0}else this.content=c[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|c[a.CHAR_DATA_WIDTH_INDEX]<<22;i&&(this.combinedData=c[a.CHAR_DATA_CHAR_INDEX],this.content=2097152|c[a.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=_},855:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},133:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(d){return d>65535?(d-=65536,String.fromCharCode(55296+(d>>10))+String.fromCharCode(d%1024+56320)):String.fromCharCode(d)},e.utf32ToString=function(d,l=0,a=d.length){let o="";for(let _=l;_<a;++_){let p=d[_];p>65535?(p-=65536,o+=String.fromCharCode(55296+(p>>10))+String.fromCharCode(p%1024+56320)):o+=String.fromCharCode(p)}return o},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(d,l){const a=d.length;if(!a)return 0;let o=0,_=0;if(this._interim){const p=d.charCodeAt(_++);56320<=p&&p<=57343?l[o++]=1024*(this._interim-55296)+p-56320+65536:(l[o++]=this._interim,l[o++]=p),this._interim=0}for(let p=_;p<a;++p){const c=d.charCodeAt(p);if(55296<=c&&c<=56319){if(++p>=a)return this._interim=c,o;const i=d.charCodeAt(p);56320<=i&&i<=57343?l[o++]=1024*(c-55296)+i-56320+65536:(l[o++]=c,l[o++]=i)}else c!==65279&&(l[o++]=c)}return o}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(d,l){const a=d.length;if(!a)return 0;let o,_,p,c,i=0,t=0,g=0;if(this.interim[0]){let S=!1,R=this.interim[0];R&=(224&R)==192?31:(240&R)==224?15:7;let A,E=0;for(;(A=63&this.interim[++E])&&E<4;)R<<=6,R|=A;const r=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,u=r-E;for(;g<u;){if(g>=a)return 0;if(A=d[g++],(192&A)!=128){g--,S=!0;break}this.interim[E++]=A,R<<=6,R|=63&A}S||(r===2?R<128?g--:l[i++]=R:r===3?R<2048||R>=55296&&R<=57343||R===65279||(l[i++]=R):R<65536||R>1114111||(l[i++]=R)),this.interim.fill(0)}const L=a-4;let x=g;for(;x<a;){for(;!(!(x<L)||128&(o=d[x])||128&(_=d[x+1])||128&(p=d[x+2])||128&(c=d[x+3]));)l[i++]=o,l[i++]=_,l[i++]=p,l[i++]=c,x+=4;if(o=d[x++],o<128)l[i++]=o;else if((224&o)==192){if(x>=a)return this.interim[0]=o,i;if(_=d[x++],(192&_)!=128){x--;continue}if(t=(31&o)<<6|63&_,t<128){x--;continue}l[i++]=t}else if((240&o)==224){if(x>=a)return this.interim[0]=o,i;if(_=d[x++],(192&_)!=128){x--;continue}if(x>=a)return this.interim[0]=o,this.interim[1]=_,i;if(p=d[x++],(192&p)!=128){x--;continue}if(t=(15&o)<<12|(63&_)<<6|63&p,t<2048||t>=55296&&t<=57343||t===65279)continue;l[i++]=t}else if((248&o)==240){if(x>=a)return this.interim[0]=o,i;if(_=d[x++],(192&_)!=128){x--;continue}if(x>=a)return this.interim[0]=o,this.interim[1]=_,i;if(p=d[x++],(192&p)!=128){x--;continue}if(x>=a)return this.interim[0]=o,this.interim[1]=_,this.interim[2]=p,i;if(c=d[x++],(192&c)!=128){x--;continue}if(t=(7&o)<<18|(63&_)<<12|(63&p)<<6|63&c,t<65536||t>1114111)continue;l[i++]=t}}return i}}},776:function(F,e,d){var l=this&&this.__decorate||function(t,g,L,x){var S,R=arguments.length,A=R<3?g:x===null?x=Object.getOwnPropertyDescriptor(g,L):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(t,g,L,x);else for(var E=t.length-1;E>=0;E--)(S=t[E])&&(A=(R<3?S(A):R>3?S(g,L,A):S(g,L))||A);return R>3&&A&&Object.defineProperty(g,L,A),A},a=this&&this.__param||function(t,g){return function(L,x){g(L,x,t)}};Object.defineProperty(e,"__esModule",{value:!0}),e.traceCall=e.setTraceLogger=e.LogService=void 0;const o=d(859),_=d(97),p={trace:_.LogLevelEnum.TRACE,debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF};let c,i=e.LogService=class extends o.Disposable{get logLevel(){return this._logLevel}constructor(t){super(),this._optionsService=t,this._logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),c=this}_updateLogLevel(){this._logLevel=p[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let g=0;g<t.length;g++)typeof t[g]=="function"&&(t[g]=t[g]())}_log(t,g,L){this._evalLazyOptionalParams(L),t.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+g,...L)}trace(t,...g){var L,x;this._logLevel<=_.LogLevelEnum.TRACE&&this._log((x=(L=this._optionsService.options.logger)===null||L===void 0?void 0:L.trace.bind(this._optionsService.options.logger))!==null&&x!==void 0?x:console.log,t,g)}debug(t,...g){var L,x;this._logLevel<=_.LogLevelEnum.DEBUG&&this._log((x=(L=this._optionsService.options.logger)===null||L===void 0?void 0:L.debug.bind(this._optionsService.options.logger))!==null&&x!==void 0?x:console.log,t,g)}info(t,...g){var L,x;this._logLevel<=_.LogLevelEnum.INFO&&this._log((x=(L=this._optionsService.options.logger)===null||L===void 0?void 0:L.info.bind(this._optionsService.options.logger))!==null&&x!==void 0?x:console.info,t,g)}warn(t,...g){var L,x;this._logLevel<=_.LogLevelEnum.WARN&&this._log((x=(L=this._optionsService.options.logger)===null||L===void 0?void 0:L.warn.bind(this._optionsService.options.logger))!==null&&x!==void 0?x:console.warn,t,g)}error(t,...g){var L,x;this._logLevel<=_.LogLevelEnum.ERROR&&this._log((x=(L=this._optionsService.options.logger)===null||L===void 0?void 0:L.error.bind(this._optionsService.options.logger))!==null&&x!==void 0?x:console.error,t,g)}};e.LogService=i=l([a(0,_.IOptionsService)],i),e.setTraceLogger=function(t){c=t},e.traceCall=function(t,g,L){if(typeof L.value!="function")throw new Error("not supported");const x=L.value;L.value=function(...S){if(c.logLevel!==_.LogLevelEnum.TRACE)return x.apply(this,S);c.trace(`GlyphRenderer#${x.name}(${S.map(A=>JSON.stringify(A)).join(", ")})`);const R=x.apply(this,S);return c.trace(`GlyphRenderer#${x.name} return`,R),R}}},726:(F,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0;const d="di$target",l="di$dependencies";e.serviceRegistry=new Map,e.getServiceDependencies=function(a){return a[l]||[]},e.createDecorator=function(a){if(e.serviceRegistry.has(a))return e.serviceRegistry.get(a);const o=function(_,p,c){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(i,t,g){t[d]===t?t[l].push({id:i,index:g}):(t[l]=[{id:i,index:g}],t[d]=t)})(o,_,c)};return o.toString=()=>a,e.serviceRegistry.set(a,o),o}},97:(F,e,d)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;const l=d(726);var a;e.IBufferService=(0,l.createDecorator)("BufferService"),e.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),e.ICoreService=(0,l.createDecorator)("CoreService"),e.ICharsetService=(0,l.createDecorator)("CharsetService"),e.IInstantiationService=(0,l.createDecorator)("InstantiationService"),function(o){o[o.TRACE=0]="TRACE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF"}(a||(e.LogLevelEnum=a={})),e.ILogService=(0,l.createDecorator)("LogService"),e.IOptionsService=(0,l.createDecorator)("OptionsService"),e.IOscLinkService=(0,l.createDecorator)("OscLinkService"),e.IUnicodeService=(0,l.createDecorator)("UnicodeService"),e.IDecorationService=(0,l.createDecorator)("DecorationService")}},Q={};function Y(F){var e=Q[F];if(e!==void 0)return e.exports;var d=Q[F]={exports:{}};return te[F].call(d.exports,d,d.exports,Y),d.exports}var ie={};return(()=>{var F=ie;Object.defineProperty(F,"__esModule",{value:!0}),F.WebglAddon=void 0;const e=Y(345),d=Y(859),l=Y(399),a=Y(666),o=Y(776);class _ extends d.Disposable{constructor(c){if(l.isSafari&&(0,l.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");super(),this._preserveDrawingBuffer=c,this._onChangeTextureAtlas=this.register(new e.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new e.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new e.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new e.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(c){const i=c._core;if(!c.element)return void this.register(i.onWillOpen(()=>this.activate(c)));this._terminal=c;const t=i.coreService,g=i.optionsService,L=i,x=L._renderService,S=L._characterJoinerService,R=L._charSizeService,A=L._coreBrowserService,E=L._decorationService,r=L._logService,u=L._themeService;(0,o.setTraceLogger)(r),this._renderer=this.register(new a.WebglRenderer(c,S,R,A,t,E,g,u,this._preserveDrawingBuffer)),this.register((0,e.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,e.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,e.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,e.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),x.setRenderer(this._renderer),this.register((0,d.toDisposable)(()=>{const C=this._terminal._core._renderService;C.setRenderer(this._terminal._core._createRenderer()),C.handleResize(c.cols,c.rows)}))}get textureAtlas(){var c;return(c=this._renderer)===null||c===void 0?void 0:c.textureAtlas}clearTextureAtlas(){var c;(c=this._renderer)===null||c===void 0||c.clearTextureAtlas()}}F.WebglAddon=_})(),ie})())})(Le);var xe=Le.exports;const Re=we(xe),ye=be({__proto__:null,default:Re},[xe]);export{ye as x};
